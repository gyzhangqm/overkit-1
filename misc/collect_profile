#! /bin/bash

set -e

if [ $# -eq 0 ]; then
  echo "ERROR: Missing argument."
  exit 1
fi

CollectData() {
  grep "$2: " $1 | cut -d' ' -f3 | tr '\n' ' '
}

PrintData() {
  data_array=($2)
  printf "$1"
  for ((i=0; i<${#data_array[@]}; i++)); do
    printf ",%s" ${data_array[$i]}
  done
  printf "\n"
}

file=$1

PrintData "" "1 2 4 8 16 32 64 128 256 512"
PrintData "Read" "$(CollectData $file "XINTOUT::Read")"
PrintData "Match" "$(CollectData $file "XINTOUT::Match")"
PrintData "Distribute" "$(CollectData $file "XINTOUT::Distribute")"
PrintData "Import" "$(CollectData $file "XINTOUT::Import")"
